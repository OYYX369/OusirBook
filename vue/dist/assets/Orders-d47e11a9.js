/* empty css                *//* empty css                   *//* empty css              *//* empty css               *//* empty css               *//* empty css                    *//* empty css                *//* empty css                     */import{r as k}from"./request-7c157a8d.js";import{r as E,o as l,c as w,d as b,e as r,w as a,h as n,s as S,z,D as I,G as V,n as s,g as p,E as f,I as D,J as B,K as U,S as $}from"./index-4e65b77a.js";const M={class:"card",style:{"margin-bottom":"5px"}},T={class:"card",style:{"margin-bottom":"5px"}},P={key:0,class:"card"},Q={__name:"Orders",setup(R){const t=E({user:JSON.parse(localStorage.getItem("system-user")||"{}"),pageNum:1,pageSize:10,total:0,formVisible:!1,form:{},tableData:[],orderNo:null}),c=()=>{k.get("/orders/selectPage",{params:{pageNum:t.pageNum,pageSize:t.pageSize,orderNo:t.orderNo}}).then(i=>{var o,u;t.tableData=(o=i.data)==null?void 0:o.list,t.total=(u=i.data)==null?void 0:u.total})},_=(i,o)=>{i.status=o,k.put("/orders/update",i).then(u=>{u.code==="200"?(c(),f.success("操作成功"),t.formVisible=!1):f.error(u.msg)})},N=i=>{D.confirm("删除后数据无法恢复，您确定删除吗?","删除确认",{type:"warning"}).then(o=>{k.delete("/orders/delete/"+i).then(u=>{u.code==="200"?(c(),f.success("操作成功")):f.error(u.msg)})}).catch(o=>{})},C=()=>{t.orderNo=null,c()};return c(),(i,o)=>{const u=S,m=z,d=B,h=U,g=$,v=I,x=V;return l(),w("div",null,[b("div",M,[r(u,{modelValue:t.orderNo,"onUpdate:modelValue":o[0]||(o[0]=e=>t.orderNo=e),style:{width:"300px","margin-right":"10px"},placeholder:"请输入订单编号查询"},null,8,["modelValue"]),r(m,{type:"primary",onClick:c},{default:a(()=>[s("查询")]),_:1}),r(m,{type:"info",style:{margin:"0 10px"},onClick:C},{default:a(()=>[s("重置")]),_:1})]),b("div",T,[r(v,{data:t.tableData,stripe:""},{default:a(()=>[r(d,{label:"订单编号",prop:"orderNo"}),r(d,{label:"农产品名称",prop:"goodsName"}),r(d,{label:"农产品图片",prop:"goodsImg"},{default:a(e=>[r(h,{style:{width:"50px",height:"50px","border-radius":"5px"},src:e.row.goodsImg,"preview-src-list":[e.row.goodsImg],"preview-teleported":""},null,8,["src","preview-src-list"])]),_:1}),r(d,{label:"购买数量",prop:"num"}),r(d,{label:"下单人",prop:"userName"}),r(d,{label:"订单状态",prop:"status"},{default:a(e=>[e.row.status==="已取消"?(l(),p(g,{key:0,type:"danger"},{default:a(()=>[s("已取消")]),_:1})):n("",!0),e.row.status==="待支付"?(l(),p(g,{key:1,type:"warning"},{default:a(()=>[s("待支付")]),_:1})):n("",!0),e.row.status==="待发货"?(l(),p(g,{key:2,type:"primary"},{default:a(()=>[s("待发货")]),_:1})):n("",!0),e.row.status==="待收货"?(l(),p(g,{key:3,type:"primary"},{default:a(()=>[s("待收货")]),_:1})):n("",!0),e.row.status==="已完成"?(l(),p(g,{key:4,type:"success"},{default:a(()=>[s("已完成")]),_:1})):n("",!0)]),_:1}),r(d,{label:"下单时间",prop:"time"}),r(d,{label:"操作",width:"160"},{default:a(e=>[t.user.role==="USER"&&e.row.status==="待支付"?(l(),p(m,{key:0,type:"primary",onClick:y=>_(e.row,"待发货")},{default:a(()=>[s("支付")]),_:2},1032,["onClick"])):n("",!0),t.user.role==="ADMIN"&&e.row.status==="待发货"?(l(),p(m,{key:1,type:"primary",onClick:y=>_(e.row,"待收货")},{default:a(()=>[s("发货")]),_:2},1032,["onClick"])):n("",!0),t.user.role==="USER"&&e.row.status==="待收货"?(l(),p(m,{key:2,type:"success",onClick:y=>_(e.row,"已完成")},{default:a(()=>[s("收货")]),_:2},1032,["onClick"])):n("",!0),t.user.role==="USER"&&e.row.status==="待支付"?(l(),p(m,{key:3,type:"danger",onClick:y=>_(e.row,"已取消")},{default:a(()=>[s("取消")]),_:2},1032,["onClick"])):n("",!0),t.user.role==="ADMIN"?(l(),p(m,{key:4,type:"danger",onClick:y=>N(e.row.id)},{default:a(()=>[s("删除")]),_:2},1032,["onClick"])):n("",!0)]),_:1})]),_:1},8,["data"])]),t.total?(l(),w("div",P,[r(x,{background:"",layout:"prev, pager, next","page-size":t.pageSize,"onUpdate:pageSize":o[1]||(o[1]=e=>t.pageSize=e),"current-page":t.pageNum,"onUpdate:currentPage":o[2]||(o[2]=e=>t.pageNum=e),total:t.total},null,8,["page-size","current-page","total"])])):n("",!0)])}}};export{Q as default};
